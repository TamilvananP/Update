<!DOCTYPE html>
<html>
<head>
  <title>AngularJS File Upoad Example with $http and FormData</title>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.4/angular.min.js"></script>
</head>

<body ng-app="fupApp">
    <div ng-controller="fupController">

        <input type="file" id="file1" name="file" multiple
            ng-files="getTheFiles($files)" />

        <input type="button" ng-click="uploadFiles()" value="Upload" />
    </div>
</body>
<script>
    angular.module('fupApp', [])
       .directive('ngFiles', ['$parse', function ($parse) {
            function fn_link(scope, element, attrs) {
                var onChange = $parse(attrs.ngFiles);
                element.on('change', function (event) {
                    onChange(scope, { $files: event.target.files });
                });
            };
            return {
                link: fn_link
            }
        } ])
	.controller('fupController', function ($scope, $http,$log) {
            var formdata = new FormData();
            $scope.getTheFiles = function ($files) {
                angular.forEach($files, function (value, key) {
                    formdata.append(key, value);
		    $log.info(formdata);
		   $log.info($files);
                });
            };
            
	$scope.uploadFiles = function () {
		$http({ method:'POST',
                        url : 'no_sql.php',
                        data:formdata,
                        headers : {'Content-Type': 'application/x-www-form-urlencoded'}
        		}).success(function(res){
                        	$log.info(res);
	                        alert(res);
         		               if (res=="True"){
                        		        $window.location.href = 'index.php';
		                        }
                	}).error(function(error){
                        	$log.info(error);
	             });

                   }
        });
</script>
</html>
